{
  "hash": "30cc6cf825bdb1d708da07a91b7c5d2a",
  "result": {
    "markdown": "---\ntitle: \"Independence and Replication\"\noutput: html_document\ndate: \"2023-05-12\"\n---\n\n\n\n\nThis section of the course considers the concepts of biological vs technical replication and pseudoreplication. To illustrate them, two example datasets are given.\n\n## Exercise 1 - Flower petals\n\nThis dataset contains three variables: `shade`, which refers to the degree of shading that the plant received while growing; `petals`, the number of petals recorded on an individual flower of that plant; and `plant`, the numerical ID assigned to the plant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflowers <- read_csv(\"data/flowers.csv\")\n```\n:::\n\n\nHaving read in the dataset, we can start by doing some visualisation and analysis. Let's have a look at how the petal number differs across the shade conditions, and then run a one-way ANOVA to compare the groups statistically.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# construct a boxplot, grouped by shade\n\nflowers %>%\n  ggplot(aes(x = shade, y = petals)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](02-replication_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# run a one-way ANOVA\n\nlm_flowers <- lm(petals ~ shade, data = flowers)\nanova(lm_flowers)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: petals\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nshade      2  50.70 25.3500  13.511 1.575e-05 ***\nResiduals 57 106.95  1.8763                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe plot and one-way ANOVA are both pretty convincing. It looks as if there are most petals on flowers in full sun, and the least petals on flowers in full shade, with partial shade somewhere in the middle.\n\nHowever, you may have noticed something about this dataset - namely, that multiple measurements of the `petals` variable have been made per plant. Or, to put it another way, though we have *biological* replicates by having measured from 12 different plants, our `petals` measurements appear to be *technical* replicates.\n\nThis dataset is a prime example of **pseudoreplication**.\n\nLet's adapt this dataset, by finding the mean petal count per plant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_flowers <- flowers %>%\n  group_by(plant, shade) %>%\n  summarise(petals = mean(petals))\n\nmean_flowers\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 Ã— 3\n# Groups:   plant [12]\n   plant shade   petals\n   <dbl> <chr>    <dbl>\n 1     1 none       4.4\n 2     2 none       7.2\n 3     3 none       6.6\n 4     4 none       5.8\n 5     5 partial    5.8\n 6     6 partial    5.2\n 7     7 partial    3.4\n 8     8 partial    4.8\n 9     9 full       5  \n10    10 full       4.2\n11    11 full       3.2\n12    12 full       2.6\n```\n:::\n:::\n\n\nNow, we have a much clearer *n* = 12. What happens if we re-run our analyses, with these mean values?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# construct a new boxplot\n\nmean_flowers %>%\n  ggplot(aes(x = shade, y = petals)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](02-replication_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# run a new ANOVA\n\nlm_mean <- lm(petals ~ shade, data = mean_flowers)\nanova(lm_mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: petals\n          Df Sum Sq Mean Sq F value  Pr(>F)  \nshade      2  10.14  5.0700  4.1824 0.05195 .\nResiduals  9  10.91  1.2122                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nIf anything, the resulting boxplot looks *more* convincing than it did before. However, we don't get the same picture with the ANOVA. The p-value is far larger than before, to the point where this analysis is no longer significant. The reason for this is simple - previously, we ran an analysis with a false *n* = 60, which gave enough power to detect an effect. However, using the true *n* = 12, we discover that all that statistical power was an illusion or artefact, and with just 12 plants, we can see only the beginning of a trend.\n\n## Exercise 2 - Cabbages\n\nEach row in the cabbages dataset refers to an individual cabbage, harvested by a farmer who has been trying to find the optimium fertiliser in his six fields. There are four variables: response variable `weight`, the weight of individual cabbages; `N_rate`, the rate of nitrogen fertiliser applied to the field in kilograms per metre; `fertiliser`, a categorical variable describing whether the fertiliser was liquid or granular; and `field`, the ID of the field that the cabbage was harvested from.\n\nStart by reading in the dataset. It's also important that we tell R to treat the `N_rate` variable as an ordinal variable, or factor, rather than as a continuous numerical variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabbages <- read_csv(\"data/cabbages.csv\")\n\ncabbages <- cabbages %>%\n  mutate(N_rate = as.factor(N_rate))\n```\n:::\n\n\nThe farmer is interested in knowing whether nitrogen rate and fertiliser type affects the weight of harvested cabbages in his fields.\n\nOn the face of it, you may therefore start by fitting a linear model with these two variables as predictors (since they're both categorical, that's a two-way ANOVA):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_cabbage <- lm(weight ~ N_rate * fertiliser, data = cabbages)\nanova(lm_cabbage)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: weight\n                  Df  Sum Sq  Mean Sq F value  Pr(>F)  \nN_rate             2 0.23306 0.116531  4.6861 0.01176 *\nfertiliser         1 0.02891 0.028910  1.1626 0.28402  \nN_rate:fertiliser  2 0.23343 0.116715  4.6935 0.01169 *\nResiduals         84 2.08885 0.024867                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThis indicates that there is a significant interaction between `N_rate` and `fertiliser`. To help us visualise the direction of that effect, we can plot the data as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabbages %>%\n  ggplot(aes(x = N_rate, y = weight, colour = fertiliser)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](02-replication_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nTogether with the ANOVA table, you might be able to make some recommendations to the farmer about the optimum fertiliser programme for his cabbages.\n\nBut - is this a sensible approach? Do we trust the conclusions?\n\nTo help you answer that question, let's visualise the effect of the `field` variable, and its relationship to other variables, with a plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncabbages %>%\n  ggplot(aes(y = weight, x = field, \n             colour = fertiliser, size = N_rate)) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using size for a discrete variable is not advised.\n```\n:::\n\n::: {.cell-output-display}\n![](02-replication_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nThis is rudimentary, but it hopefully helps to illustrate one of two problems with the approach taken here: our different treatments/conditions in the `fertiliser` and `N_rate` variables have been applied, wholesale, to entire fields. Which makes sense, practically speaking - it's hard to see how you would do any differently - but it does mean that there are issues with treating individual cabbages as independent observations, rather than technical replicates.\n\nHave a think about how you could actually investigate this question, using the dataset presented here. What is our actual value of *n*? (Or put another way: which are our biological replicates?) What kind of model might you fit instead of the linear model fitted above?\n\n## Summary\n\n::: {.callout-tip}\n#### Key Points\n\n- Biological replicates increase *n*, while technical replicates do not\n- The value of *n* can have a meaningful impact on the results of significance tests\n- Pseudoreplication in a sample can lead to a researcher drawing the wrong conclusions\n:::",
    "supporting": [
      "02-replication_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}